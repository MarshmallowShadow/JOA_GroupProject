<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="list">


<!-- 페이지 + 검색 -->
<select id="getListPage" parameterType="map" resultType="ListVo">
	<![CDATA[
		SELECT ort.rn,
		        ort.q_list_no,
		        ort.user_no,
		        ort.board_category,
		        ort.title,
		        ort.content,
		        ort.reg_date,
		        ort.view_count
		FROM (SELECT rownum rn,
		                ot.q_list_no,
		                ot.user_no,
		                ot.board_category,
		                ot.title,
		                ot.content,
		                ot.reg_date,
		                ot.view_count
		        FROM (SELECT q_list_no,
		                        user_no,
		                        board_category,
		                        title,
		                        content,
		                        reg_date,
		                        view_count
		                FROM q_list
		                ORDER BY reg_date)ot
		                )ort
         where rn>=#{startRnum}
         and rn<=#{endRnum}
	]]>
</select>


<!-- 삭제 -->
<delete id="delete">
	<![CDATA[
		delete list
		where no = #{no}
	]]>
</delete>

<!-- //조회수 (hitUpdate) -->
<!-- <update id="hitUpdate" parameterType="int">
	<![CDATA[
		update list
		set hit = hit+1
		where no = #{no}
	]]>

</update>
 -->
 
<!-- 상세페이지 읽기 -->
<select id="getList" parameterType="int" resultType="map">
	<![CDATA[
		select u.id,
		        q.q_list_no qListNo,
		        q.board_category boardCategory,
		        q.title,
		        q.content,
		        to_char(q.reg_date, 'YYYY-MM-DD'),
		        q.view_count viewCount
		from users u, q_list q
		where u.user_no = q.user_no
		and q_list_no = #{no}
	]]>
</select>

<!-- 글쓰기 -->
<insert id="listWrite" parameterType="ListVo">
	<![CDATA[
		insert into q_list
		values(seq_q_list_no.nextval, #{userNo}, #{boardCategory}, #{title}, #{content}, sysdate, 0)
	]]>
</insert>


<!-- 리스트 출력 -->
<select id="selectList" parameterType="String" resultType="map">
	<![CDATA[
		select q.q_list_no, 
				q.board_category, 
				u.id,
				q.title, 
				q.reg_date, 
				q.view_count
		from q_list q, users u
		where u.user_no = q.user_no
	]]>
</select>
 
</mapper>