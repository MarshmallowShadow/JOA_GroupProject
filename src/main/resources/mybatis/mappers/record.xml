<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="record">

	<!-- 기록 추가하기 -->
	<insert id="insert" parameterType="recVo">
		<selectKey keyProperty="recordNo" resultType="int" order="BEFORE">
			select SEQ_RECORD_NO.nextval from dual
		</selectKey>
		
		<![CDATA[
			insert into record
			values (#{recordNo}, #{courseNo}, #{userNo}, #{review}, #{weather}, #{temperature}, #{courseCate}, #{courseTime}, #{difficulty}, #{regDate})
		]]>
	</insert>
	
	<!-- (이미지추가) 기록번호 가져오기 -->
	<select id="getrecNo" resultType="int">
		<![CDATA[
			select last_number
			from user_sequences
			where sequence_name = 'SEQ_RECORD_NO'
		]]>
	</select>
	
	<!-- (코스상세보기) 기록수 가져오기 -->
	<select id="recCnt" parameterType="int" resultType="int">
		<![CDATA[
			select  count(*)
			from record
			where course_no = #{courseNo}
		]]>
	</select>
	
	<!-- (코스상세보기) 기록통계-종목 가져오기 -->
	<select id="getCateCnt" parameterType="int" resultType="hashmap">
		<![CDATA[
			select course_category courseCate
			       ,count(course_category) cnt
			from record
			group by course_no, course_category
			having course_no = #{courseNo}
		]]>
	</select>
	
	<!-- (코스상세보기) 기록통계-난이도 가져오기 -->
	<select id="getDiffiCnt" parameterType="int" resultType="hashmap">
		<![CDATA[
			select  difficulty
			        ,count(difficulty) cnt
			from record
			group by course_no, difficulty
			having course_no = #{courseNo}
		]]>
	</select>

</mapper>