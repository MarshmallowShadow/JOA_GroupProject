<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">

	<!-- 리스트 불러오기 + 페이징 -->
	<select id="board" parameterType="String" resultType="map">
		<![CDATA[
			select ort.rn
		           , ort.boardNo
		           , ort.boardCategory
		           , ort.title
		           , ort.id
		           , ort.viewCount
		           , ort.regDate
		           , ort.userNo
			from (select rownum rn
	                     , ot.boardNo
	                     , ot.boardCategory
	                     , ot.title
	                     , ot.id
	                     , ot.viewCount
	                     , ot.regDate
	                     , ot.userNo
		          from (select b.board_no boardNo
		          			   , b.board_category boardCategory
	                           , b.title
	                           , u.id
	                           , b.view_count viewCount
	                           , to_char(b.reg_date,'YYYY-MM-DD') regDate
	                           , b.user_no userNo
	                  from board b, users u
	                  where u.user_no = b.user_no
	                  order by b.board_no desc)ot
	                  )ort
			where rn>=#{startRnum}
			and rn<=#{endRnum}
		]]>
	</select>
	
	
	<!-- 전체 글갯수 구하기 -->
	<select id="selectTotalCnt" resultType="int">
		<![CDATA[
			select count(*) count
			from board b, users u
			where b.user_no = u.user_no
		]]>
	</select>
	
	
	<!-- 검색 -->
	<select id="getList" parameterType="String" resultType="map">
		<![CDATA[
			select b.board_no boardNo
				   , b.board_category boardCategory
			       , b.title
			       , u.id
			       , b.view_count viewCount
			       , to_char(b.reg_date,'YYYY-MM-DD HH24:MI') regDate
			       , b.user_no userNo
			from board b, users u
			where u.user_no = b.user_no
			and title like #{keyword}
		]]>
	</select>
	
	
	<!-- 게시판 글쓰기(둘 다 null) -->
	<insert id="insertBoth" parameterType="BoardVo">
		<![CDATA[
			insert into board (board_no, user_no, board_category, title, content, reg_date, view_count)
			values(SEQ_BOARD_NO.nextval, #{userNo}, #{boardCategory}, #{title}, #{content}, sysdate, 0)
		]]>
	</insert>
	<!-- 게시판 글쓰기(코스 null) -->
	<insert id="insertCourse" parameterType="BoardVo">
		<![CDATA[
			insert into board (board_no, user_no, event_no, board_category, title, content, reg_date, view_count)
			values(SEQ_BOARD_NO.nextval, #{userNo}, #{eventNo}, #{boardCategory}, #{title}, #{content}, sysdate, 0)
		]]>
	</insert>
	<!-- 게시판 글쓰기(함께하기 null) -->
	<insert id="insertTogether" parameterType="BoardVo">
		<![CDATA[
			insert into board (board_no, user_no, course_no, board_category, title, content, reg_date, view_count)
			values(SEQ_BOARD_NO.nextval, #{userNo}, #{courseNo}, #{boardCategory}, #{title}, #{content}, sysdate, 0)
		]]>
	</insert>
	<!-- 게시판 글쓰기(전체) -->
	<insert id="insertAll" parameterType="BoardVo">
		<![CDATA[
			insert into board (board_no, user_no, course_no, event_no, board_category, title, content, reg_date, view_count)
			values(SEQ_BOARD_NO.nextval, #{userNo}, #{courseNo}, #{eventNo}, #{boardCategory}, #{title}, #{content}, sysdate, 0)
		]]>
	</insert>

</mapper>